{
	"name": "RDL_Queries",
	"properties": {
		"content": {
			"query": "--Batch Service Call Summary\n--Report\nSELECT  svc.SVCCALLID, \n\t\tsvc.INVENTLOCATIONID, \n\t\tsvc.INVOICEACCOUNTNAME AS [INVOICE NAME], \n\t\tsvc.CUSTNAME, \n\t\tsvc.CUSTACCOUNT,\n                                svc.Subject,\n\t\tsvcType.CALLSTATUSID, \n        svcTypeTable.CALLTYPEID, \n\t\tsvc.CREATEDBY, \n\t\tsvcReason.REASONCODE, \n\t\tsvcReason.DESCRIPTION, \n        svc.CREATEDDATETIME,\n\t\tsvc.WRKCTRID 'PERSONNELNUMBER',\n\t\tdir.name,\n\t\teq.equipmentid,\n\t\teq.INVENTSERIALID,\n\t\tmake.MANUFACTURERID,\n\t\tmodel.TYPEID,\n\t\tsvcRep.Incident,\n\t\teqUsage.SMULAST,\n\t\tctShipTo.MEMO 'ShipToMemo',\n\t\tlpa.ADDRESS,\n\t\tsvc.CONTACTPERSONNAME\n\t\t,svc.IVRNumber\n\t\t,svc.PONumber\n\t\t,eqTech.CUSTEQUIPMENTNUMBER\n\t\t,svc.WENNSOFTID\nFROM dbo.XAP_SVCCALLTABLE svc \nLEFT JOIN dbo.XAP_SVCCALLREASONCODES svcReason ON svc.CALLREASONCODE = svcReason.RECID \nLEFT JOIN dbo.XAP_SVCCALLTYPETABLE svcTypeTable ON svc.CALLTYPEID = svcTypeTable.RECID \nLEFT JOIN dbo.XAP_SVCCALLTYPELINE svcType ON svc.CALLSTATUS = svcType.RECID\nLEFT join HCMWORKER wrker on svc.WRKCTRID = wrker.PERSONNELNUMBER\nLEFT join DIRPARTYTABLE dir on wrker.PERSON = dir.RECID\nLEFT join INVENTLOCATION il on il.INVENTLOCATIONID = svc.INVENTLOCATIONID\nLEFT join DEFAULTDIMENSIONVIEW ddv on ddv.DEFAULTDIMENSION = il.DEFAULTDIMENSION and ddv.DIMENSIONATTRIBUTEID = 5637145333\nleft join xap_equipmenttable eq on eq.recid = svc.equipmentid\nleft join XAP_EQUIPMENTTECHNICALINFO eqTech on eq.RECID = eqTech.EQUIPMENT\nleft join XAP_MACHINEMANUFACTURER make on eq.MACHINEMANUFACTURER = make.RECID\nleft join XAP_MACHINETYPE model on eq.MACHINETYPE= model.RECID\nleft join XAP_SVCREPORTINGTABLE svcRep on svcRep.RECID = svc.REPORTINGTABLEREFERENCE\nleft join XAP_EQUIPMENTUSAGETABLE eqUsage on eq.RECID = eqUsage.EQUIPMENT\nleft join CUSTTABLE ctShipTo on ctShipTo.ACCOUNTNUM = svc.CUSTACCOUNT\nleft join DIRPARTYLOCATION dirp on dirp.PARTY = ctShipTo.PARTY and dirp.ISPRIMARY = 1\nleft join LOGISTICSPOSTALADDRESS lpa on lpa.LOCATION = svc.DELIVERYADDRESS and lpa.VALIDTO > getdate()\nwhere SVCCALLID in (@svccallid)\n--Pending commission by Salesperson V2\n--Dataset1\nSELECT a.*\n  FROM [BriggsAX].[dbo].[Briggs_CommissionDailyDW_Unpaid] a\n  where exists (SELECT salesmancode  FROM [BriggsAX].[dbo].[eqa_User_AllUsers] b  \n\t\twhere networkalias = replace(@uid,'BRIGGSEQUIPMENT\\','')\n\t\tand a.[territory] = b.salesmancode)\n\t\t\n--Commission summary by Salesperson\n--Report\nSELECT *\n  FROM [BriggsAX].[dbo].[Briggs_CommissionDailyDW] a\n  where exists (SELECT salesmancode  FROM [BriggsAX].[dbo].[eqa_User_AllUsers] b  \n\t\twhere username = replace(@uid,'BRIGGSEQUIPMENT\\','')\n\t\tand a.[territory] = b.salesmancode)\n\t\tand RIGHT('0'+CAST(MONTH(a.invoicedate) AS VARCHAR) + '/' + CAST(YEAR(a.invoicedate) AS VARCHAR),7) =@Date\n\t\tand a.salesplan <> '14'\n\n\n--paramUsername\nselect replace(@uid,'BRIGGSEQUIPMENT\\','')\n\n--ParamSalespersonLookup\nSELECT * FROM [BriggsAX].[dbo].[eqa_User_AllUsers] b  where username = replace(@uid,'BRIGGSEQUIPMENT\\','')\n\n--ParamDateSelect\nSELECT distinct MONTH(INVOICEDATE)'month',YEAR(INVOICEDATE) 'year', RIGHT('0'+CAST(MONTH(INVOICEDATE) AS VARCHAR) + '/' + CAST(YEAR(INVOICEDATE) AS VARCHAR),7) 'monthyear'\n  FROM [BriggsAX].[dbo].[Briggs_CommissionDailyDW] a\n  order BY 2 DESC,1 DESC\n  \n--ParamCurrentMonth\nselect RIGHT('0'+CAST(MONTH(getdate()) AS VARCHAR) + '/' + CAST(YEAR(getdate()) AS VARCHAR),7) 'monthyear'\n\n--Commission Summary by Salesperson V2\n--Report\nSELECT a.*\n  FROM [BriggsAX].[dbo].[Briggs_CommissionDailyDW_PayComOnPay] a\n  where exists (SELECT salesmancode  FROM [BriggsAX].[dbo].[eqa_User_AllUsers] b  \n\t\twhere networkalias = \n\t\t\t(case when \n\t\t\treplace(@uid,'BRIGGSEQUIPMENT\\','') = 'nrountree' then 'mrountree'\n\t\t\telse replace(@uid,'BRIGGSEQUIPMENT\\','')\n\t\t\tend)\n\t\tand a.[territory] = b.salesmancode)\n\t\tand (Case when cast(RIGHT(@Date,4) as smallint) >=2021 then\n\t\t\tRIGHT('0'+CAST(MONTH(a.[LastSettleDate]) AS VARCHAR) + '/' + CAST(YEAR(a.[LastSettleDate]) AS VARCHAR),7) \n\t\tElse \n\t\t\tRIGHT('0'+CAST(MONTH(a.[InvoiceDate]) AS VARCHAR) + '/' + CAST(YEAR(a.[InvoiceDate]) AS VARCHAR),7)\n\t\tEnd) = @Date\n\t\tand a.salesplan <> '14'\n\nUNION ALL\n\nSELECT c.* \n\n  FROM [BriggsAX].[dbo].[Briggs_CommissionDW] c\n  where exists (SELECT salesmancode  FROM [BriggsAX].[dbo].[eqa_User_AllUsers] d  \n\t\twhere networkalias = \n\t\t\t(case when \n\t\t\treplace(@uid,'BRIGGSEQUIPMENT\\','') = 'nrountree' then 'mrountree'\n\t\t\telse replace(@uid,'BRIGGSEQUIPMENT\\','')\n\t\t\tend)\n\t\tand c.[territory] = d.salesmancode)\n\t\tand (Case when cast(RIGHT(@Date,4) as smallint) >=2021 then\n\t\t\tRIGHT('0'+CAST(MONTH(c.[LastSettleDate]) AS VARCHAR) + '/' + CAST(YEAR(c.[LastSettleDate]) AS VARCHAR),7) \n\t\tElse \n\t\t\tRIGHT('0'+CAST(MONTH(c.[InvoiceDate]) AS VARCHAR) + '/' + CAST(YEAR(c.[InvoiceDate]) AS VARCHAR),7)\n\t\tEnd) = @Date\n\t\tand c.salesplan <> '14'\n\t\t\n--ParamUsername\nselect replace(@uid,'BRIGGSEQUIPMENT\\','')\n\n--ParamSalespersonLookup\nSELECT * FROM [BriggsAX].[dbo].[eqa_User_AllUsers] b  where username = replace(@uid,'BRIGGSEQUIPMENT\\','')\n\n--ParamDateSelect\nselect distinct c.*\n\nfrom(\n\nSELECT distinct MONTH(INVOICEDATE)'month',YEAR(INVOICEDATE) 'year', RIGHT('0'+CAST(MONTH(INVOICEDATE) AS VARCHAR) + '/' + CAST(YEAR(INVOICEDATE) AS VARCHAR),7) 'monthyear'\n  FROM [BriggsAX].[dbo].[Briggs_CommissionDailyDW_PayComOnPay] a\n\n\nUNION ALL\n\nSELECT distinct MONTH(INVOICEDATE)'month',YEAR(INVOICEDATE) 'year', RIGHT('0'+CAST(MONTH(INVOICEDATE) AS VARCHAR) + '/' + CAST(YEAR(INVOICEDATE) AS VARCHAR),7) 'monthyear'\n  FROM [BriggsAX].[dbo].[Briggs_CommissionDW] a\n) as c\n\n  order BY 2 DESC,1 DESC\n  \n--ParamCurrentMonth\n  select RIGHT('0'+CAST(MONTH(getdate()) AS VARCHAR) + '/' + CAST(YEAR(getdate()) AS VARCHAR),7) 'monthyear'\n  \n--Commission Summary by Salesperson v2 Manager\n--Report\nSELECT a.*, 'DailyPCOP'\n  FROM [BriggsAX].[dbo].[Briggs_CommissionDailyDW_PayComOnPay] a\n  where \n\t\t (Case when cast(RIGHT(@Date,4) as smallint) >=2021 then\n\t\t\tRIGHT('0'+CAST(MONTH(a.[LastSettleDate]) AS VARCHAR) + '/' + CAST(YEAR(a.[LastSettleDate]) AS VARCHAR),7) \n\t\tElse \n\t\t\tRIGHT('0'+CAST(MONTH(a.[InvoiceDate]) AS VARCHAR) + '/' + CAST(YEAR(a.[InvoiceDate]) AS VARCHAR),7)\n\t\tEnd) = @Date\n\t\tand a.salesplan <> '14'\n\t\tand a.SalesPerson1 in (@salesperson)\n\nUNION ALL\n\nSELECT b.* , 'CommsDW'\n\n\tFROM [BriggsAX].[dbo].[Briggs_CommissionDW] b\n\twhere \n\t\t(Case when cast(RIGHT(@Date,4) as smallint) >=2021 then\n\t\t\tRIGHT('0'+CAST(MONTH(b.[LastSettleDate]) AS VARCHAR) + '/' + CAST(YEAR(b.[LastSettleDate]) AS VARCHAR),7) \n\t\tElse \n\t\t\tRIGHT('0'+CAST(MONTH(b.[InvoiceDate]) AS VARCHAR) + '/' + CAST(YEAR(b.[InvoiceDate]) AS VARCHAR),7)\n\t\tEnd) = @Date\n\t\tand b.salesplan <> '14'\n\t\tand b.SalesPerson1 in (@salesperson)\n\t\t\n--ParamUsername\nselect replace(@uid,'BRIGGSEQUIPMENT\\','')\n\n--ParamSalespersonLookup\nSELECT * FROM [BriggsAX].[dbo].[eqa_User_AllUsers] b  where username = replace(@uid,'BRIGGSEQUIPMENT\\','')\n\n--ParamDateSelct\nselect distinct c.*\n\nfrom(\n\nSELECT distinct MONTH(INVOICEDATE)'month',YEAR(INVOICEDATE) 'year', RIGHT('0'+CAST(MONTH(INVOICEDATE) AS VARCHAR) + '/' + CAST(YEAR(INVOICEDATE) AS VARCHAR),7) 'monthyear'\n  FROM [BriggsAX].[dbo].[Briggs_CommissionDailyDW_PayComOnPay] a\n\n\nUNION ALL\n\nSELECT distinct MONTH(INVOICEDATE)'month',YEAR(INVOICEDATE) 'year', RIGHT('0'+CAST(MONTH(INVOICEDATE) AS VARCHAR) + '/' + CAST(YEAR(INVOICEDATE) AS VARCHAR),7) 'monthyear'\n  FROM [BriggsAX].[dbo].[Briggs_CommissionDW] a\n) as c\n\n  order BY 2 DESC,1 DESC\n  \n--ParamCurrentMonth\n  select RIGHT('0'+CAST(MONTH(getdate()) AS VARCHAR) + '/' + CAST(YEAR(getdate()) AS VARCHAR),7) 'monthyear'\n  \n --salesperson\n SELECT distinct*\n  FROM\n\t(select distinct SalesPerson1  \n\t\tfrom  [BriggsAX].[dbo].[Briggs_CommissionDailyDW_PayComOnPay] a\n\t\tWHERE\t\t (Case when cast(RIGHT(@Date,4) as smallint) >=2021 then\n\t\t\tRIGHT('0'+CAST(MONTH(a.[LastSettleDate]) AS VARCHAR) + '/' + CAST(YEAR(a.[LastSettleDate]) AS VARCHAR),7) \n\t\tElse \n\t\t\tRIGHT('0'+CAST(MONTH(a.[InvoiceDate]) AS VARCHAR) + '/' + CAST(YEAR(a.[InvoiceDate]) AS VARCHAR),7)\n\t\tEnd) = @Date\n\t\tAND a.SalesPerson1 <> ''\n\t\tand a.branch in (@Branch)\nunion all \n\nselect distinct SalesPerson1 from [BriggsAX].[dbo].[Briggs_CommissionDW] b\nWHERE\t\t (Case when cast(RIGHT(@Date,4) as smallint) >=2021 then\n\t\t\tRIGHT('0'+CAST(MONTH(b.[LastSettleDate]) AS VARCHAR) + '/' + CAST(YEAR(b.[LastSettleDate]) AS VARCHAR),7) \n\t\tElse \n\t\t\tRIGHT('0'+CAST(MONTH(b.[InvoiceDate]) AS VARCHAR) + '/' + CAST(YEAR(b.[InvoiceDate]) AS VARCHAR),7)\n\t\tEnd) = @Date\n\t\tAND b.SalesPerson1 <> ''\n\t\tand b.branch in (@Branch)) as c\norder by 1\n\n--ParamBranch\nSELECT distinct*\n  FROM\n\t(select distinct branch\n\t\tfrom  [BriggsAX].[dbo].[Briggs_CommissionDailyDW_PayComOnPay] a\n\t\tWHERE\t\t (Case when cast(RIGHT(@Date,4) as smallint) >=2021 then\n\t\t\tRIGHT('0'+CAST(MONTH(a.[LastSettleDate]) AS VARCHAR) + '/' + CAST(YEAR(a.[LastSettleDate]) AS VARCHAR),7) \n\t\tElse \n\t\t\tRIGHT('0'+CAST(MONTH(a.[InvoiceDate]) AS VARCHAR) + '/' + CAST(YEAR(a.[InvoiceDate]) AS VARCHAR),7)\n\t\tEnd) = @Date\n\t\tAND a.branch <> ''\nunion all \n\nselect distinct branch from [BriggsAX].[dbo].[Briggs_CommissionDW] b\n\t\tWHERE\t\t (Case when cast(RIGHT(@Date,4) as smallint) >=2021 then\n\t\t\tRIGHT('0'+CAST(MONTH(b.[LastSettleDate]) AS VARCHAR) + '/' + CAST(YEAR(b.[LastSettleDate]) AS VARCHAR),7) \n\t\tElse \n\t\t\tRIGHT('0'+CAST(MONTH(b.[InvoiceDate]) AS VARCHAR) + '/' + CAST(YEAR(b.[InvoiceDate]) AS VARCHAR),7)\n\t\tEnd) = @Date\n\t\tAND b.branch <> '') as c\norder by 1\n\n--Current Inventory\n--TS\nselect * from AAAImportStamp\n\n--Report\nselect * from [BriggsAX].[dbo].[cache_BriggsCurrentInventory]\nwhere [FleetType] in (@fleettype)\nand isnull([BelongsTo],'') in (@belongsto)\nand  isnull([Warehhouse],'') in (@warehouse)\nand PhysicalStatus <> 'Sold'\nand PhysicalStatus in (@physicalstatus)\nand agrementstatus in (@agreementstatus)\nand Model in (@model)\norder by [BelongsTo],FleetType,itemid\n\n--ParamBranch\nwith all_br\nas(\n\nSELECT distinct DISPLAYVALUE,DISPLAYVALUE_Value\n  FROM [BriggsAX].[dbo].[Branch_Equipment]\nunion\n\nSELECT distinct DISPLAYVALUE, DISPLAYVALUE_Value\n  FROM [BriggsAX].[dbo].[Branch_Parts]\n)\n\nselect *\nfrom all_br\norder by [Displayvalue]\n\n--ParamsFleetType\nselect * from FleetTypes where BATCHTEMPLATEID in ('Used','Used Rental','Rental','Lease','New','Like Kind Exchange','Used lease')\n\n--ParamMakes\nselect a.MANUFACTURERID,a.RECID from XAP_MACHINEMANUFACTURER a\nwhere exists (select * from XAP_EQUIPMENTTABLE b where a.RECID = b.MACHINEMANUFACTURER)\norder by 1\n\n--ParamModel\nselect a.TYPEID,a.RECID\nfrom XAP_MACHINETYPE a\ninner join XAP_MACHINEMANUFACTURER b on a.MACHINEMANUFACTURER = b.recid\nwhere b.MANUFACTURERID in (@make)\norder by 1\n\n--ParamPhysicalStatus\nselect * from BRIGGS_PhysicalStatus order by 1\n\n--ParamAgreementStatus\nselect * from [dbo].[BRIGGS_AgreementStatus]  order by 1\n\n--Param_WH\nSELECT DISTINCT INVENTLOCATIONID\nFROM BRANCH_EQUIPMENT\nORDER BY INVENTLOCATIONID",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "master",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}