{
	"name": "DimAnalysisforAR",
	"properties": {
		"content": {
			"query": "--Department\n--1. Department_ID\n select [OMOPERATINGUNITNUMBER] from [Briggs_MST].[OMDepartmentView_ext]\n--2. Department\nselect [NAME] from [Briggs_MST].[OMDepartmentView_ext]\n--3. Primary_Function \t\nselect\n\t\tcase\n\t\t\twhen o.OMOPERATINGUNITNUMBER like '2%' and o.OMOPERATINGUNITNUMBER <> '28' then 'Operations'\n\t\t\twhen o.OMOPERATINGUNITNUMBER like '3%' or o.OMOPERATINGUNITNUMBER = '28' then 'Sales'\n\t\t\twhen o.OMOPERATINGUNITNUMBER like '8%' then 'Support'\n\t\t\telse 'Unknown'\n\t\tend 'Primary_Function' \nfrom [Briggs_MST].[OMDepartmentView_ext]\n--4. Secondary_Function\nselect\n\t  case\n\t\t\twhen o.OMOPERATINGUNITNUMBER  = '24' then 'Sales'\n\t\t\twhen o.OMOPERATINGUNITNUMBER  = '28' then 'Operations'\n\t\t\twhen o.OMOPERATINGUNITNUMBER = '32' then 'Support'\n\t\t\twhen o.OMOPERATINGUNITNUMBER like '2%' then 'Operations'\n\t\t\twhen o.OMOPERATINGUNITNUMBER like '3%' then 'Sales'\n\t\t\twhen o.OMOPERATINGUNITNUMBER like '8%' then 'Support'\n\t\t\telse 'Unknown'\n\t  end 'Secondary_Function' \nfrom [Briggs_MST].[OMDepartmentView_ext]\n--5.Department_Head\nselect NAME from [Briggs_MST].[DIRPartyTable_ext]\n\n--Customer\n--1. Customer_ID\nselect accountnum from [Briggs_MST].[CustTable_ext]\n--2. Customer_Name\nselect name from [Briggs_MST].[DIRPartyTable_ext]\n--3. Customer\nselect (ct.accountnum + ' - ' + dir.name) from [Briggs_MST].[CustTable_ext], [Briggs_MST].[DIRPartyTable_ext]\n--4. Customer_Account_Type\nselect\n\tcase \n\t\twhen ct.INVOICEACCOUNT = '' then 'Bill-to'\n\t\twhen ct.INVOICEACCOUNT <> '' then 'Ship-to'\n\t\telse null \n\tend 'Customer_Account_Type' \nfrom [Briggs_MST].[CustTable_ext]\n--5. Date_Account_Opened\nselect isnull(cast([DATE_OPENED] as date),cast(ct.CREATEDDATETIME as date)) from [Briggs_MST].[CustTable_ext]\n--6. Customer_Group\nselect NAME from [Briggs_MST].[CustGroup_ext]\n--7. Collections_Agent\nselect\nrtrim(ltrim(case\n\twhen ccg.DESCRIPTION like 'TAA%' then  ccg.DESCRIPTION\n\telse isnull(substring(ccg.DESCRIPTION,charindex('-',ccg.DESCRIPTION)+1,len(ccg.DESCRIPTION)),'NO REP')\nEND)) \nfrom [Briggs_MST].[XAP_CreditCustomerGroups_ext]\n--8. Account_Hold_Type\nselect \n\tcase \n\t\twhen ct.blocked = 0 then 'None'\n\t\twhen ct.blocked = 3 then 'Payment'\n\t\twhen ct.blocked = 20 then 'Stopped'\n\t\twhen ct.blocked = 2 then 'All'  \n\t\telse 'None'\n\tend 'Account_Hold_Type'\nfrom [Briggs_MST].[CustTable_ext]\n--9. PO_Required\nselect \n\tcase when ct.POREQUIRED = 1 then 'Yes' else 'No' \n\tend 'PO_Required'\nfrom [Briggs_MST].[CustTable_ext]\n--10. Collection_Type_Description\nselect isnull(BCT.DESCRIPTION,'Unknown') 'Collection_Type_Description' \nfrom from [Briggs_MST].[BRGCollectionType_ext]\n\n--Worker\n--1.WorkerID\nselect hcm.PERSONNELNUMBER 'Worker_ID' from [Briggs_MST].[HCMWorker_ext]\n--2. Worker_Name\nselect dir.NAME 'Worker_Name' from [Briggs_MST].[DIRPartyTable_ext]\n--3. Username\nselect isnull(du.USER_,'NoUser') 'Username' from [Briggs_MST].[DirPersonUser_ext]\n--4. Job\nselect e.Job from [BriggsAX].[RosterEmployee_ext]\n--5. Department\nselect Department from [BriggsAX].[RosterEmployee_ext]\n--6.Branch\nselect Branch from [BriggsAX].[RosterEmployee_ext]\n\n--dim_Branch\n--1. BranchID\nselect br.[VALUE] 'Branch_ID' from [Briggs_MST].[DefaultDimensionView_ext]\n--2. Branch\nselect dir.[NAME] 'Branch' from [Briggs_MST].[DIRPartyTable_ext]\n--3. Address\nselect ISNULL(ISNULL(p_addr.ADDRESS,pc.ADDRESS),'Unknown') 'Address' from [Briggs_MST].[LogisticsPostalAddress_ext]\n--4. Street\nselect ISNULL(ISNULL(p_addr.STREET,pc.STREET),'Unknown') 'Street' from [Briggs_MST].[LogisticsPostalAddress_ext]\n--5. City\nselect ISNULL(ISNULL(p_addr.CITY,pc.CITY),'Unknown') 'City' from [Briggs_MST].[LogisticsPostalAddress_ext]\n--6. State\nselect ISNULL(ISNULL(p_addr.STATE,pc.STATE),'Unknown') 'State' from [Briggs_MST].[LogisticsPostalAddress_ext]\n--7. Zip_code\nselect ISNULL(CAST(ISNULL(p_addr.ZIPCODE,pc.ZIPCODE) AS VARCHAR(20)),'Unknown') 'Zip_Code' from [Briggs_MST].[LogisticsPostalAddress_ext]\n\n--dim_WorkCenter\n--1. Work_Center_ID\nselect WC.WRKCTRID 'Work_Center_ID' from [Briggs_MST].[WrkCtrTable_ext]\n--2. Work_Center_Name\nselect WC.NAME 'Work_Center_Name' from [Briggs_MST].[WrkCtrTable_ext]\n--3. Work_Center_Type\nselect\n\tCASE\n\t\tWHEN WC.WRKCTRTYPE = 2 THEN 'Vendor'\n\t\twhen wc.WRKCTRTYPE = 5 then 'Group'\n\t\twhen wc.WRKCTRTYPE = 1 and hcm.PERSONNELNUMBER is not null then 'Individual Employee'\n\t\twhen wc.WRKCTRTYPE = 1 then 'Individual Non-Employee'\n\t\telse 'Unknown'\n\tend 'Work_Center_Type'\nfrom [Briggs_MST].[WrkCtrTable_ext]\n--4.Work_Center_Group\nselect\n\tCASE\n\t\tWHEN WC.WRKCTRTYPE = 5 THEN 'NA'\n\t\twhen WG.WRKCTRID IS NULL then 'Unknown'\n\t\telse WG.WRKCTRID\n\tend 'Work_Center_Group'\nfrom [Briggs_MST].[WrkCtrResourceGroup_ext]\n--5.is_WOrker\nselect\n\tCASE \n\t\tWHEN WC.WRKCTRTYPE IN(2,5) THEN 'No'\n\t\twhen wc.WRKCTRTYPE = 1 and hcm.PERSONNELNUMBER is not null then 'Yes'\n\t\tWHEN wc.WRKCTRTYPE = 1 and HCM.PERSONNELNUMBER IS NULL THEN 'No'\n\t\telse 'Unknown'\n\tend 'is_Worker'\nfrom [Briggs_MST].[WrkCtrTable_ext]\n--6.WOrker_ID\nselect\n\tCASE \n\t\tWHEN WC.WRKCTRTYPE IN(2,5) THEN 'NA'\n\t\twhen wc.WRKCTRTYPE = 1 and hcm.PERSONNELNUMBER is not null then hcm.PERSONNELNUMBER\n\t\tWHEN wc.WRKCTRTYPE = 1 and HCM.PERSONNELNUMBER IS NULL THEN 'NA'\n\t\telse 'Unknown'\n\tend 'Worker_ID'\nfrom [Briggs_MST].[WrkCtrTable_ext]\n--7.Worker_Name\nselect\n\tCASE \n\t\tWHEN WC.WRKCTRTYPE IN(2,5) THEN 'NA'\n\t\twhen wc.WRKCTRTYPE = 1 and hcm.PERSONNELNUMBER is not null then DIR.NAME\n\t\tWHEN wc.WRKCTRTYPE = 1 and HCM.PERSONNELNUMBER IS NULL THEN 'NA'\n\t\telse 'Unknown'\n\tend 'Worker_Name'\nfrom [Briggs_MST].[WrkCtrTable_ext]\n--8.Worker_Team\nselect\n\tCASE \n\t\tWHEN WC.WRKCTRTYPE IN(2,5) THEN 'NA'\n\t\twhen wc.WRKCTRTYPE = 1 and hcm.PERSONNELNUMBER is not null then isnull(replace(la.languagecodeid,'TEAM','Team'),'Unknown')\n\t\tWHEN wc.WRKCTRTYPE = 1 and HCM.PERSONNELNUMBER IS NULL THEN 'NA'\n\t\telse 'Unknown'\n\tend 'Worker_Team'\nfrom [Briggs_MST].[WrkCtrTable_ext]\n\n--Warehouse\n--1. Warehouse SK\nselect a.RECID 'SK_Warehouse_BIGINT' from [Briggs_MST].[InventLocation_ext]\n--2. Warehouse_ID\nselect a.INVENTLOCATIONID 'Warehouse_ID' from [Briggs_MST].[InventLocation_ext]\n--3. Warehouse\nselect\n\tcase \n\t\twhen a.INVENTSITEID = 'PARTS' then 'Parts - '\n\t\twhen a.INVENTSITEID = 'EQUIPMENT' then 'Equipment - '\n\tend\n\t\t+\n\t\tbr.NAME \n\t'Warehouse'\nfrom [Briggs_MST].[InventLocation_ext]\n--4.Site\nselect a.INVENTSITEID 'Site' from [Briggs_MST].[InventLocation_ext]\n--5. Transaction_Status\nselect\n\tcase \n\t\twhen isnull(sls_wip.[Open],0) + isnull(svc_wip.[Open],0) = 0 then 'Inactive'\n\t\telse 'Active'\n\tend 'Transaction_Status'\nfrom sls_wip\n(select st.INVENTLOCATIONID,count(*) 'Open'\nfrom briggs_mst.dbo.SALESTABLE st\nwhere st.SALESSTATUS = 2\ngroup by st.INVENTLOCATIONID)\n--6. Address\nselect isnull(isnull(e.ADDRESS,p.ADDRESS),'Unknown Address') 'Address' from e_addr\n(e_addr\nas(\nselect \n--distinct\n il.INVENTLOCATIONID\n,STREET\n,ZIPCODE\n,CITY\n,STATE\n,ADDRESS\nfrom [Briggs_MST].[InventLocation_ext] il\nleft join [Briggs_MST].[InventLocationLogisticsLocationPrimary_ext] a on il.recid = a.INVENTLOCATION\nleft join [Briggs_MST].[LogisticsPostalAddressView_ext] lv on lv.LOCATION = a.LOCATION and lv.VALIDTO >= getdate()\nwhere il.INVENTLOCATIONID like 'E%')\n--7. Street\nselect isnull(isnull(e.STREET,p.street),'Unknown Address') 'Street' from e_addr\n--8.City\nselect isnull(isnull(e.CITY,p.CITY),'Unknown Address') 'City' from e_addr\n--9.State\nselect isnull(isnull(e.STATE,p.STATE),'Unknown Address') 'State' from e_addr\n--10. Zip_code\nselect isnull(isnull(e.ZIPCODE,p.ZIPCODE),'Unknown Address') 'Zip_Code' from e_addr\n--11. Transit_ID\nselect a.INVENTLOCATIONIDTRANSIT 'Transit_ID' from [Briggs_MST].[InventLocation_ext]\n\n--DIM_Region\n--1.Region\nselect m.MEMO 'Region' from [Briggs_MST].[DIRPartyMemo_ext]\n--2.Region_Leader\nselect\n\tcase \n\t\twhen dir_ldr.[NAME] is null or dir_ldr.[NAME] = '' then 'Inactive Branch' \n\t\telse dir_ldr.[NAME]\n\tend 'Region_Leader'\nfrom [Briggs_MST].[DIRPartyTable_ext]\n--3. Branch_Tech_Empl_Status\nselect\n\tcase \n\t\twhen isnull(es.employees,0) = 0 then 'Inactive'\n\t\telse 'Active'\n\tend 'Branch_Tech_Empl_Status'\nfrom tech_status\n(tech_status\nas(\n\nselect \nbranch\n,count(*) 'Employees'\n\nfrom briggsax.dbo.roster_employee e\nwhere e.file_date = (select max(file_date) from briggsax.dbo.roster_employee)\nand e.Status = 'Active'\nand e.Position_Ledger_Code = '600010'\ngroup by branch)\n\n--Territory Salesperson\n--1. SK_Territory_Salesperson\nselect cs.RECID 'SK_Territory_Salesperson_BIGINT' from [BriggsAX].[CommissionsSalesPeople_ext]\n--2. Territory_Salesperson_ID\nselect cs.territory 'Territory_Salesperson_ID' from [BriggsAX].[CommissionsSalesPeople_ext]\n--3. Territory_Salesperson_Branch\nselect db.Branch 'Territory_Salesperson_Branch' from [Briggs_MST].[DIRPartyTable_ext]\n--4. Territory_Salesperson_Default_Branch\nselect isnull(db2.Branch,'Unknown') 'Territory_Salesperson_Default_Branch' from [Briggs_MST].[DIRPartyTable_ext]\n--5. Territory_Salesperson_Division\nselect cs.division 'Territory_Salesperson_Division' from [BriggsAX].[CommissionsSalesPeople_ext]\n--6. Plan\nselect cs.[type] 'Territory_Salesperson_Plan' from [BriggsAX].[CommissionsSalesPeople_ext]\n\n--Dim_Calltypes\n--1. SK_Call_Type\nselect tt.recid 'SK_Call_Type_BIGINT' from [Briggs_MST].[XAP_SVCCallTable_ext]\n,\nselect tt.CALLTYPEID 'Call_Type_ID' from [Briggs_MST].[XAP_SVCCallTable_ext]\n,\nselect tl.CALLSTATUSID 'Call_Status_ID' from [Briggs_MST].[XAP_SVCCallTypeLine_ext]\n,\nselect tl.LINENUM 'Line_Num' from [Briggs_MST].[XAP_SVCCallTypeLine_ext]\n\n--GL_Account\n--1.\nselect m.RECID 'SK_Ledger_Account_BIGINT' from [Briggs_MST].[MainAccount_ext]\n,\nselect m.MAINACCOUNTID 'Ledger_Account_ID' from [Briggs_MST].[MainAccount_ext]\n,\nselect m.NAME 'Ledger_Account' from [Briggs_MST].[MainAccount_ext]\n,\nselect mc.DESCRIPTION 'Description' from [Briggs_MST].[MainAccountCategory_ext]\n,\nselect mc.ACCOUNTCATEGORY 'Account_Category' from [Briggs_MST].[MainAccountCategory_ext]\n,\nselect mc.ACCOUNTTYPE 'Account_Type' from [Briggs_MST].[MainAccountCategory_ext]\n\n--Dim_Emp\n--1. SK_Employee\nSELECT cast(e.employee_id as bigint) 'SK_Employee_BIGINT' from [BriggsAX].[RosterEmployee_ext]\n,\nselect e.Employee_ID 'Employee_ID' from [BriggsAX].[RosterEmployee_ext]\n,\nselect e.Employee_Name 'Name_LFM' from [BriggsAX].[RosterEmployee_ext]\n,\nselect \n\tcase\n\t\twhen e.[Status] like 'Term%' then 'Terminated'\n\t\twhen e.[Status] like 'Inact%' then 'Inactive'\n\t\telse e.[Status]\n\tend 'Employment_Status'\nfrom [BriggsAX].[RosterEmployee_ext]\n,\nselect jj.CategoryDescription 'Job_Category' from [BriggsHR].[JobCategory_ext]\n,\nselect e.[Job] 'Job' from [BriggsAX].[RosterEmployee_ext]\n,\nselect e.Last_Hire_Date 'Last_Hire_Date' from [BriggsAX].[RosterEmployee_ext]\n\n\n--Supervisor\nselect isnull(m.Employee_Name,'Unknown') 'Supervisor_Name_LFM' from [BriggsAX].[RosterEmployee_ext]\n,\nselect isnull(dbm.Branch,'Unknown') 'Supervisor_Branch' from [Briggs_MST].[DIRPartyTable_ext]\n,\nselect isnull(ddm.[Department],'Unknown') 'Supervisor_Department' from [Briggs_MST].[OMDepartmentView_ext]\n,\nselect isnull(jjm.CategoryDescription,'Unknown') 'Supervisor_Job_Category' from [BriggsHR].[JobCategory_ext]\n,\nselect isnull(m.[Job],'Unknown') 'Supervisor_Job' from [BriggsAX].[RosterEmployee_ext]\n,\nselect isnull(m.Last_Hire_Date,'1900-01-01') 'Supervisor_Last_Hire_Date' from [BriggsAX].[RosterEmployee_ext]\n,\nselect cast(e.[File_Date] as date) 'Roster_Valid_To' from [BriggsAX].[RosterEmployee_ext]\n\n--dim_AssignedSalesPerson\n--1.\nselect isnull(sp.Salesperson_Name_AX,'Unassigned') 'Assigned_Salesperson' from [BriggsAX].[CommissionsSalesPeople_ext]\n,\nselect isnull(sp.Salesperson_Branch_Roster,'Unassigned') 'Assigned_Salesperson_Roster_Branch' from [Briggs_MST].[DIRPartyTable_ext]\n,\nselect isnull(sp.Territory_Salesperson_Default_Branch,'Unassigned') 'Assigned_Salesperson_Terr_Default_Branch' from [Briggs_MST].[DIRPartyTable_ext]\n,\nselect isnull(sp.Territory_Salesperson_Branch,'Unassigned') 'Assigned_Salesperson_Terr_Branch' from [Briggs_MST].[DIRPartyTable_ext]\n,\nselect\n\tcase\n\t\twhen sp.Salesperson_Worker_ID_AX like 'SLS%' then 'NA'\n\t\telse isnull(sp.Salesperson_Department_Roster,'Unassigned')\n\tend 'Assigned_Salesperson_Empl_Status'\nfrom [BriggsAX].[RosterEmployee_ext]",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "master",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}